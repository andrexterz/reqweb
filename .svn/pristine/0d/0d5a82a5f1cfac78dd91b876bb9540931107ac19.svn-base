/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package br.ufg.reqweb.components;

import br.ufg.reqweb.dao.CursoDao;
import java.io.Serializable;
import java.util.List;

import javax.faces.application.FacesMessage;
import javax.faces.context.FacesContext;
import javax.faces.event.ActionEvent;

import org.primefaces.context.RequestContext;
import org.springframework.stereotype.Component;

import br.ufg.reqweb.model.Curso;
import java.util.HashMap;
import java.util.Map;
import java.util.ResourceBundle;
import org.apache.log4j.Logger;
import org.springframework.beans.factory.annotation.Autowired;

/**
 *
 * @author andre
 */
@Component
public class CursoBean implements Serializable {

    public CursoBean() {
        curso = new Curso();
        operation = null;
    }
    
    @Autowired
    private CursoDao cursoDao;
    private static final long serialVersionUID = 1L;
    private Curso curso;

    private String operation;//a: adiciona | e: edita
    public static final String ADICIONA = "a";
    public static final String EDITA    = "e";
    ResourceBundle messages = ResourceBundle.getBundle(
            "locale.messages",
            FacesContext.getCurrentInstance().getViewRoot().getLocale());
    
    public String novoCurso() {
        setOperation(ADICIONA);
        curso = new Curso();
        return "cursoDialog";
    }
    
    public void editaCurso() {
         setOperation(EDITA);
    }

    public String excluiCurso() {
        return "cursos";
    }
    
    public String listaCursos() {
        return "cursos";
    }
    
    public String salvaCurso() {
        Logger log = Logger.getLogger(CursoBean.class);
        RequestContext context = RequestContext.getCurrentInstance();
        FacesMessage msg = null;

        if (curso.getMatriz().equals("") || curso.getNome().equals("") || curso.getSigla().equals("")) {
            msg = new FacesMessage(FacesMessage.SEVERITY_ERROR, "info", messages.getString("dadosInvalidos"));
            FacesContext.getCurrentInstance().addMessage(null, msg);
            return null;
        }
        else {
            msg = new FacesMessage(FacesMessage.SEVERITY_INFO, "info", messages.getString("dadosSalvos"));
            if (operation.equals(ADICIONA)) {
                cursoDao.adicionar(curso);
            }
            else {
                cursoDao.atualizar(curso);
            }
            FacesContext.getCurrentInstance().addMessage(null, msg);
        }
        return "cursos";
    }
    
    public List getCursos() {
        return cursoDao.listar();
    }
    
    /**
     * @return the curso
     */
    public Curso getCurso() {
        return curso;
    }

    /**
     * @param curso the curso to set
     */
    public void setCurso(Curso curso) {
        this.curso = curso;
    }
    
    public String getOperation() {
        return operation;
    }
    
    public void setOperation(String operation) {
        this.operation = operation;
    }
}
