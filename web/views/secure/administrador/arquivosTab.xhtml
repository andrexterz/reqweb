<ui:composition template="administrador.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:f="http://xmlns.jcp.org/jsf/core">
    <ui:define name="componentTitle">#{msg.arquivos}</ui:define>
    <ui:define name="content">
        <script>
            $(document).ready(function() {
                jQuery("#arquivosLnk").addClass("menuItemSelected");
            });
        </script>
        <p:tabView>
            <p:tab id="tab1" title="#{msg.disciplinas}">
                <h:form id="disciplinasForm" enctype="multipart/form-data" styleClass="formToolbar contentTables">
                    <h:panelGroup layout="block" id="disciplinasToolbar" styleClass="formToolbar">
                        <p:commandButton value="#{msg.novo}"
                                         process="@this"
                                         actionListener="#{disciplinaBean.novaDisciplina}"
                                         oncomplete="PF('dlgDisciplinaVar').show()"
                                         update="tableDisciplinas" />

                        <p:commandButton value="#{msg.editar}"
                                         disabled="#{!disciplinaBean.selecionado}"
                                         process="@this"
                                         actionListener="#{disciplinaBean.editaDisciplina}"
                                         oncomplete="PF('dlgDisciplinaVar').show()"
                                         update="tableDisciplinas" />


                        <p:commandButton value="#{msg.excluir}"
                                         styleClass="formToolbarButtons"
                                         update="tableDisciplinas"
                                         disabled="#{!disciplinaBean.selecionado}"
                                         oncomplete="PF('excluirDisciplinaDialog').show()"
                                         process="@this" />

                        <p:commandButton value="#{msg.importar}" />

                        <p:commandButton value="#{msg.exportar} #{msg.paraCSV}" ajax="false">
                            <p:fileDownload value="#{disciplinaBean.disciplinasAsCSV}" />
                        </p:commandButton>                

                        <p:autoComplete id="cursoFiltro" styleClass="autoComplete"
                                        converter="#{cursoConverter}" value="#{disciplinaBean.curso}"
                                        minQueryLength="4"
                                        var="c" itemLabel="#{c.nome}" itemValue="#{c}" forceSelection="true"
                                        completeMethod="#{cursoBean.findCurso}">
                            <p:ajax event="itemSelect" listener="#{disciplinaBean.autoCompleteSelecionaCurso}" />
                        </p:autoComplete>
                        <p:watermark for="cursoFiltro" value="#{msg.curso}" />

                        <p:inputText id="disciplinaBusca"
                                     styleClass="searchBox"
                                     value="#{disciplinaBean.termoBusca}" />

                        <p:watermark for="disciplinaBusca" value="#{msg.disciplina}" />

                        <!-- ao pressionar <return>, o formulario submete o commandButton[id=disciplinaCommand] -->
                        <p:commandButton style="visibility: hidden;"
                                         id="disciplinaBuscaCommand"
                                         styleClass="searchCommand alignRight"
                                         update="tableDisciplinas" />

                        <p:defaultCommand target="disciplinaBuscaCommand" />

                    </h:panelGroup>                     
                    <p:dataTable id="tableDisciplinas"
                                 paginator="true"
                                 value="#{disciplinaBean.disciplinasDataModel}"
                                 var="disciplinaItem"
                                 lazy="true"
                                 emptyMessage="#{msg.emptyMessage}"
                                 rowKey="#{disciplinaItem.id}"
                                 selectionMode="single"
                                 selection="#{disciplinaBean.itemSelecionado}"
                                 paginatorPosition="bottom"
                                 rows="10" pageLinks="5">
                        <p:ajax event="rowSelect" />
                        <p:column headerText="#{msg.codigo}" styleClass="disciplinaColA">
                            <h:outputText value="#{disciplinaItem.codigo}" />
                        </p:column>
                        <p:column headerText="#{msg.disciplina}" styleClass="disciplinaColB">
                            <h:outputText value="#{disciplinaItem.nome}" />
                        </p:column>
                        <p:column headerText="#{msg.curso}" styleClass="disciplinaColC">
                            <h:outputText value="#{disciplinaItem.curso.nome}" />
                        </p:column>
                    </p:dataTable>
                </h:form>                

            </p:tab>
            <p:tab id="tab2" title="#{msg.turmas}">
                #{msg.turmas}
            </p:tab>
            <p:tab id="tab3" title="#{msg.indicePrioridade}">
                #{msg.indicePrioridade}
            </p:tab>
        </p:tabView>
    </ui:define>
</ui:composition>

