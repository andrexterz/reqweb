<ui:composition template="administrador.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:f="http://xmlns.jcp.org/jsf/core">
    <ui:define name="componentTitle">#{msg.usuarios}</ui:define>
    <ui:define name="content">
        <script>
            $(document).ready(function() {
                jQuery("#usuariosLnk").addClass("menuItemSelected");
                console.log("marcando menuItemSelected como selecionado");
            });
        </script>
        <ui:include src="importaUsuarioForm.xhtml"  />
        <ui:include src="salvaUsuarioForm.xhtml"  />
        <ui:include src="excluiUsuarioForm.xhtml" />
        <ui:include src="detalheUsuarioForm.xhtml" />
        <h:form class="contentTables" id="usuarioForm">
            <h:panelGroup layout="block" id="usuarioToolbar">

                <p:commandButton value="#{msg.usuarioLDAP}"
                                 oncomplete="handleImportDialog('importaUsuarioLDAPDialogVar')"
                                 update=":usuarioLDAPForm:paraImpButton :usuarioLDAPForm:progressBarUsuario"
                                 actionListener="#{usuarioBean.setupImportUsuarios}"
                                 process="@this" />

                <p:commandButton value="#{msg.editar}"
                                 process="@this"
                                 update=":dlgUsuarioForm"
                                 oncomplete="PF('dlgUsuarioVar').show()"
                                 disabled="#{usuarioBean.selecionado == false}"
                                 actionListener="#{usuarioBean.editaUsuario}" />

                <p:commandButton value="#{msg.excluir}"
                                 disabled="#{usuarioBean.selecionado== false}"
                                 onclick="PF('excluirUsuarioDialog').show()" />

                <p:commandButton value="#{msg.usuarioDetalheValue}" icon="ui-icon-search"
                                 disabled="#{usuarioBean.selecionado == false}"
                                 update=":dlgDetalheUsuarioForm"
                                 oncomplete="PF('dlgDetalheUsuarioVar').show()"
                                 />

                <p:inputText id="usuarioBusca" styleClass="searchBox" value="#{usuarioBean.termoBusca}" />
                <p:watermark for="usuarioBusca" value="#{msg.usuarioNome}/#{msg.usuarioMatricula}" />
                <!-- ao pressionar <return>, o formulario submete o commandButton[id=usuarioBuscaCommand] -->
                <p:commandButton style="visibility: hidden;" id="usuarioBuscaCommand"  styleClass="searchCommand alignRight" update="tableUsuarios" />                
                <p:defaultCommand target="usuarioBuscaCommand" />

            </h:panelGroup>

            <p:dataTable id="tableUsuarios" var="usuarioItem"
                         value="#{usuarioBean.usuariosDataModel}"
                         lazy="true"
                         emptyMessage="#{msg.emptyMessage}"
                         rowKey="#{usuarioItem.id}"
                         paginator="true"
                         selectionMode="single"
                         selection="#{usuarioBean.itemSelecionado}"
                         paginatorPosition="bottom"
                         rows="10" pageLinks="5">
                <p:ajax event="rowSelect" update=":excluiUsuarioForm:dlgExclUsuarioDialog :usuarioForm:usuarioToolbar :detalheUsuarioForm" listener="#{usuarioBean.selecionaItem}" />
                <p:ajax event="page" update=":excluiUsuarioForm:dlgExclUsuarioDialog :usuarioForm:usuarioToolbar :detalheUsuarioForm tableUsuarios" />
                <p:column headerText="#{msg.usuario}" styleClass="usuarioColLogin">
                    <h:outputText value="#{usuarioItem.login}" />
                </p:column>
                <p:column headerText="#{msg.usuarioMatricula}" styleClass="usuarioColMatricula">
                    <h:outputText value="#{usuarioItem.matricula}" />
                </p:column>                
                <p:column headerText="#{msg.usuarioNome}" styleClass="usuarioColNome">
                    <h:outputText value="#{usuarioItem.nome}" />
                </p:column>
            </p:dataTable>
        </h:form>
    </ui:define>
</ui:composition>
