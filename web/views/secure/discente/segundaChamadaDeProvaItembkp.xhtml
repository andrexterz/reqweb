<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:f="http://xmlns.jcp.org/jsf/core">
    <p:column>
        <h:outputLabel value="#{msg.status}" />
    </p:column>
    <p:column>
        <p:selectOneButton value="#{itemRequerimento.status}">
            <f:selectItem itemLabel="#{msg.aberto}"
                          itemValue="ABERTO" itemDisabled="#{itemRequerimento.status != 'ABERTO'}" />
            <f:selectItem itemLabel="#{msg.deferido}"
                          itemValue="DEFERIDO" itemDisabled="#{usuarioBean.perfil == 'DISCENTE'}" />
            <f:selectItem itemLabel="#{msg.indeferido}"
                          itemValue="INDEFERIDO" itemDisabled="#{usuarioBean.perfil == 'DISCENTE'}" />
        </p:selectOneButton>                            
    </p:column>
    <p:column>
        <h:outputLabel value="#{msg.turma}" />
    </p:column>
    <p:column headerText="#{msg.turma}">
        <p:autoComplete id="turmaRequerimento" value="#{itemRequerimento.turma}"
                        converter="#{turmaConverter}"
                        minQueryLength="3" maxResults="10" var="t"
                        itemLabel="#{t}" itemValue="#{t}"
                        forceSelection="true" completeMethod="#{turmaBean.findTurma}">
            <p:ajax event="itemSelect" update="docenteTurma" listener="#{requerimentoBean.autoCompleteSelecionaTurma}" />
        </p:autoComplete>
        <p:watermark for="turmaRequerimento" value="#{msg.turma}" />
    </p:column>
    <p:column>
        <h:outputLabel value="#{msg.docente}" />
    </p:column>    
    <p:column>
        <h:outputText id="docenteTurma" value="#{itemRequerimento.turma.docente.nome}" />
    </p:column>
    <p:column>
        <p:tabView styleClass="arquivoBox" dynamic="true">
            <p:ajax event="tabChange" update="novoArquivo" listener="#{requerimentoBean.novoArquivoTabEvent}" />
            <p:tab id="arquivoTab1" title="#{msg.arquivos}">
                <p:dataList id="arquivos" emptyMessage="#{msg.emptyMessage}"
                            type="ordered"
                            value="#{requerimentoBean.arquivos}" var="arq">
                    <p:commandLink value="#{arq.nomeArquivo}" ajax="false">
                        <f:setPropertyActionListener target="#{requerimentoBean.arquivo}" value="#{arq}" />
                        <p:fileDownload value="#{requerimentoBean.arquivoContent}" />
                    </p:commandLink>
                </p:dataList>
            </p:tab>
            <p:tab id="arquivoTab2" title="#{msg.novo} #{msg.arquivo}">
                <p:panelGrid id="novoArquivo" styleClass="formGrid">
                    <p:row>
                        <p:column>
                            <h:outputLabel value="#{msg.nome}" />
                        </p:column>
                        <p:column>
                            <p:inputText id="arquivoNome" value="#{itemArquivo.nomeArquivo}" />
                            <p:watermark for="arquivoNome" value="#{msg.nome}" />
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column colspan="2">
                            <p:fileUpload id="arquivoContent"
                                          label="#{msg.selecionar}"
                                          uploadLabel="#{msg.enviar}"
                                          cancelLabel="#{msg.cancelar}"
                                          disabled="#{requerimentoBean.arquivoEnviado}"
                                          allowTypes="/(\.|\/)(gif|jpe?g|png)$/"
                                          fileLimit="1"
                                          multiple="false"
                                          process="@this"
                                          sizeLimit="1048576"
                                          fileUploadListener="#{requerimentoBean.uploadArquivo}"
                                          update="arquivoButtons arquivoContent :formHeader:systemMessages" />
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column colspan="2">
                            <h:panelGroup id="arquivoButtons" layout="block" styleClass="formFooterButtons alignRight">
                                <p:commandButton id="addArquivo" value="#{msg.adicionar}"
                                                 process="@this"
                                                 actionListener="#{requerimentoBean.novoArquivo}"
                                                 disabled="#{!requerimentoBean.arquivoEnviado}"
                                                 update="novoArquivo :formHeader:systemMessages" />
                            </h:panelGroup>
                        </p:column>

                    </p:row>
                </p:panelGrid>
            </p:tab>
        </p:tabView>
    </p:column>    
    <p:column>
        <h:outputLabel value="#{msg.observacao}" />
    </p:column>
    <p:column>
        <p:inputTextarea rows="5" cols="32" autoResize="false" 
                         value="#{requerimentoBean.requerimento.observacao}" />
    </p:column>
</ui:composition>

